#add a comment
name: Deploy
on:
  release:
    types:
      - published
jobs:
  build:
    name: Build
    if: ${{ !github.event.release.prerelease && github.event.release.target_commitish == 'master' }}
    runs-on: ubuntu-latest
    steps:
      - uses: octokit/request-action@v2.x
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        id: get_repo_permissions_for_user
        with:
          route: GET /repos/:owner/:repo/collaborators/:username/permission
          owner: hamermike # ${{ github.event.organization.name }}
          repo: ${{ github.event.repository.name }}
          username: ${{ github.event.release.author.login }}
      - run: echo "Permission - ${{ fromJson(steps.get_repo_permissions_for_user.outputs.data).permission }}"
      - run: exit ${{ fromJson(steps.get_repo_permissions_for_user.outputs.data).permission }} == 'admin'
      - uses: actions/checkout@v2
      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: '2.2.x'
      - run: dotnet build
